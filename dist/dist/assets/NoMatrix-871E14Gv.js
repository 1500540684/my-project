import{_ as V,r as g,p as S,q as M,v as N,c as f,d as e,e as n,f as i,g as _,t as m,b as q,x as B,u as A,o as u,y as D,z as J,j as h,E as l,A as O,m as T}from"./index-Bqka696Z.js";const U={class:"no-matrix-container"},$={class:"content-box"},z={class:"matrix-warning-box"},E={class:"info-section info-section-outline"},Q={class:"info-table-outline"},R={class:"info-row-outline"},L={class:"info-value-outline"},j={class:"info-value-outline"},F={class:"info-row-outline"},H={class:"info-value-outline"},K={class:"info-value-outline"},P={class:"copy-button-outline"},W={class:"google-title-row"},X={key:0,class:"google-status unbind"},Y={key:1,class:"google-status binded"},Z={class:"google-card"},ss={class:"google-card-right"},es={class:"google-qrcode"},as={class:"qrcode-placeholder"},ts=["src"],os={class:"google-form"},ls={class:"action-buttons"},ns={__name:"NoMatrix",setup(is){const x=A(),t=g({}),b=g(""),r=g(!1),p=g("");S(()=>{try{const a=localStorage.getItem("userInfo");a&&(t.value=JSON.parse(a))}catch(a){console.error("加载用户信息失败:",a)}y(),w()});const y=async()=>{try{const a=await M();a.code===200&&a.data&&a.data.qrCode&&(b.value=a.data.qrCode,typeof a.data.enabled<"u"&&(r.value=!!a.data.enabled))}catch(a){console.error("获取谷歌二维码失败",a)}},w=async()=>{var a;try{const s=await N();s&&typeof((a=s.data)==null?void 0:a.enabled)<"u"&&(r.value=!!s.data.enabled)}catch{}},k=()=>{const a=`
用户名: ${t.value.username||"-"}
用户ID: ${t.value.id||"-"}
手机号: ${t.value.phone||"-"}
邮箱: ${t.value.email||"-"}
  `.trim();navigator.clipboard.writeText(a).then(()=>{l.success("账号信息已复制到剪贴板")}).catch(()=>{l.error("复制失败，请手动复制")})},I=async()=>{try{const a=await T();a.code===200?(localStorage.setItem("matrixInfo",JSON.stringify(a.data)),l.success("验证成功"),x.push("/")):(r.value=!1,l.warning("未绑定Matrix账号"))}catch(a){console.error("检查Matrix账号失败:",a),l.error("验证失败，请稍后重试")}},C=()=>{x.push("/")},G=async()=>{if(!p.value){l.warning("请输入验证码");return}try{const a=await O({token:p.value});if(a.code===200){l.success("绑定成功"),r.value=!0;let s=[];const d=localStorage.getItem("GGisValid");if(d)try{s=JSON.parse(d)}catch(c){console.error("解析GGisValid失败:",c)}const o={isValid:!0,phone:t.value.phone,email:t.value.email,timestamp:new Date().getTime()},v=s.findIndex(c=>c.phone===o.phone&&c.email===o.email);v!==-1?s[v]=o:s.push(o),localStorage.setItem("GGisValid",JSON.stringify(s))}else l.error(a.msg||"验证码错误")}catch{l.error("请求失败，请稍后重试")}};return(a,s)=>{const d=_("el-icon"),o=_("el-button"),v=_("el-input");return u(),f("div",U,[e("div",$,[s[15]||(s[15]=e("h2",{class:"page-title"},"账号安全设置",-1)),e("div",z,[n(d,{class:"warning-triangle"},{default:i(()=>[n(D(J))]),_:1}),s[1]||(s[1]=e("div",{class:"matrix-warning-texts"},[e("span",{class:"matrix-warning-title"},"您尚未绑定Matrix账号"),e("span",{class:"matrix-warning-desc"}," 您当前无法使用系统功能，因为您的账号尚未绑定Matrix系统。请将下方账号信息提供给管理员，绑定成功后即可正常使用系统功能。 ")],-1))]),e("div",E,[s[7]||(s[7]=e("div",{class:"info-section-title"},"您的账号信息",-1)),e("div",Q,[e("div",R,[s[2]||(s[2]=e("div",{class:"info-label-outline"},"用户名",-1)),e("div",L,m(t.value.username||"-"),1),s[3]||(s[3]=e("div",{class:"info-label-outline"},"用户ID",-1)),e("div",j,m(t.value.id||"-"),1)]),e("div",F,[s[4]||(s[4]=e("div",{class:"info-label-outline"},"手机号",-1)),e("div",H,m(t.value.phone||"-"),1),s[5]||(s[5]=e("div",{class:"info-label-outline"},"邮箱",-1)),e("div",K,m(t.value.email||"-"),1)])]),e("div",P,[n(o,{type:"primary",size:"small",onClick:k},{default:i(()=>s[6]||(s[6]=[h(" 复制信息 ")])),_:1})])]),e("div",W,[n(d,{class:"google-icon"},{default:i(()=>s[8]||(s[8]=[e("svg",{viewBox:"0 0 24 24",width:"1em",height:"1em"},[e("g",null,[e("circle",{cx:"12",cy:"12",r:"10",fill:"#4285F4"}),e("path",{d:"M12 7a5 5 0 1 1 0 10 5 5 0 0 1 0-10z",fill:"#fff"})])],-1)])),_:1}),s[9]||(s[9]=e("span",{class:"google-title"},"谷歌身份验证器(非必选)",-1)),r.value?(u(),f("span",Y,"已绑定")):(u(),f("span",X,"未绑定"))]),e("div",Z,[s[12]||(s[12]=q('<div class="google-card-left" data-v-3a2439ab><ul class="step-list-custom" data-v-3a2439ab><li data-v-3a2439ab><span class="step-circle" data-v-3a2439ab>1</span><span class="step-main" data-v-3a2439ab><span class="step-label" data-v-3a2439ab>下载谷歌身份验证器</span><span class="step-desc" data-v-3a2439ab>在手机应用商店搜索&quot;Google Authenticator&quot;下载安装</span></span></li><li data-v-3a2439ab><span class="step-circle" data-v-3a2439ab>2</span><span class="step-main" data-v-3a2439ab><span class="step-label" data-v-3a2439ab>扫描二维码</span><span class="step-desc" data-v-3a2439ab>打开谷歌验证器，扫描右侧二维码</span></span></li><li data-v-3a2439ab><span class="step-circle" data-v-3a2439ab>3</span><span class="step-main" data-v-3a2439ab><span class="step-label" data-v-3a2439ab>输入验证码</span><span class="step-desc" data-v-3a2439ab>输入谷歌验证器生成的6位动态验证码完成绑定</span></span></li></ul></div>',1)),e("div",ss,[e("div",es,[e("div",as,[b.value?(u(),f("img",{key:0,src:b.value,alt:"谷歌二维码",style:{width:"100px",height:"100px"}},null,8,ts)):(u(),B(d,{key:1},{default:i(()=>s[10]||(s[10]=[e("svg",{viewBox:"0 0 48 48",width:"64",height:"64"},[e("rect",{x:"8",y:"8",width:"32",height:"32",rx:"4",fill:"#f2f3f5",stroke:"#dcdfe6"}),e("rect",{x:"16",y:"16",width:"8",height:"8",fill:"#dcdfe6"}),e("rect",{x:"24",y:"24",width:"8",height:"8",fill:"#dcdfe6"})],-1)])),_:1}))])]),e("div",os,[n(v,{modelValue:p.value,"onUpdate:modelValue":s[0]||(s[0]=c=>p.value=c),placeholder:"请输入6位验证码",maxlength:"6",class:"google-code-input"},null,8,["modelValue"]),n(o,{type:"primary",class:"google-bind-btn",onClick:G},{default:i(()=>s[11]||(s[11]=[h("绑定")])),_:1})])])]),s[16]||(s[16]=e("div",{class:"info-section"},[e("h3",{class:"section-title"},"联系管理员"),e("p",{class:"section-desc"},"请通过以下方式联系管理员为您绑定Matrix账号："),e("ul",{class:"contact-list"},[e("li",null,"电话：400-888-8888"),e("li",null,"邮箱：admin@gopay.com"),e("li",null,"工作时间：周一至周五 9:00-18:00")])],-1)),e("div",ls,[n(o,{type:"primary",onClick:I},{default:i(()=>s[13]||(s[13]=[h("重新检查")])),_:1}),n(o,{onClick:C},{default:i(()=>s[14]||(s[14]=[h("跳过")])),_:1})])])])}}},cs=V(ns,[["__scopeId","data-v-3a2439ab"]]);export{cs as default};
