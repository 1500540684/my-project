import{_ as x,r as c,c as A,d,e,f as a,g as i,j as _,o as D,y as q,ax as B,E as v}from"./index-Bqka696Z.js";import{h as F}from"./card-BIPI8pB_.js";const Y={class:"create-cardholder-dialog-outer"},$={class:"main-title-row"},M={class:"section-block"},R={class:"form-card"},S={class:"section-block"},E={class:"form-card"},j={class:"footer-btns"},H={__name:"CreateCardholder",emits:["close","success"],setup(K,{emit:h}){const l=c({country:"",firstName:"",lastName:"",birthday:"",email:"",phonePrefix:"86",phone:"",billCountry:"",billProvince:"",billCity:"",billAddress:"",billPostcode:""}),P={country:[{required:!0,message:"请选择国家",trigger:"change"}],firstName:[{required:!0,message:"请输入名",trigger:"blur"}],lastName:[{required:!0,message:"请输入姓",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号格式",trigger:"blur"}],birthday:[{required:!0,message:"请选择生日",trigger:"change"}],phonePrefix:[{required:!0,message:"请选择手机区号",trigger:"change"}]},b=c(null),N=c(null);function w(n){if(!n)return 0;const t=new Date,f=new Date(n);let r=t.getFullYear()-f.getFullYear();const m=t.getMonth()-f.getMonth();return(m<0||m===0&&t.getDate()<f.getDate())&&r--,r}async function U(){if(b.value)try{if(await b.value.validate(),w(l.value.birthday)<18){v.error("用卡人年龄必须大于18岁");return}const t=[l.value.billAddress,l.value.billCity,l.value.billCountry,l.value.billPostcode,l.value.billProvince],f=t.some(s=>s),r=t.every(s=>s);if(f&&!r){const s=[];l.value.billCountry||s.push("国家"),l.value.billProvince||s.push("省份/州"),l.value.billCity||s.push("城市"),l.value.billAddress||s.push("详细地址"),l.value.billPostcode||s.push("邮编"),v.error(`请填写完整的账单地址信息：${s.join("、")}`);return}const m={firstName:l.value.firstName,lastName:l.value.lastName,dateOfBirth:l.value.birthday,email:l.value.email,mobile:l.value.phone,mobilePrefix:l.value.phonePrefix,nationalityCountryCode:l.value.country,residentialAddress:r?l.value.billAddress:"",residentialCity:r?l.value.billCity:"",residentialCountryCode:r?l.value.billCountry:"",residentialPostalCode:r?l.value.billPostcode:"",residentialState:r?l.value.billProvince:""},u=await F(m);u.code===200?(v.success("创建用卡人成功"),g("close"),g("success")):v.error(u.msg||"创建用卡人失败")}catch(n){console.error("创建用卡人失败:",n),v.error(n.message||"创建用卡人失败")}}const g=h;return(n,t)=>{const f=i("el-icon"),r=i("el-option"),m=i("el-select"),u=i("el-form-item"),s=i("el-col"),p=i("el-input"),k=i("el-date-picker"),y=i("el-row"),V=i("el-form"),C=i("el-button");return D(),A("div",Y,[d("div",$,[t[14]||(t[14]=d("span",{class:"main-title"},"创建用卡人",-1)),e(f,{class:"close-btn",onClick:t[0]||(t[0]=o=>n.$emit("close"))},{default:a(()=>[e(q(B))]),_:1})]),d("div",M,[t[15]||(t[15]=d("div",{class:"section-title"},"新用卡人",-1)),t[16]||(t[16]=d("div",{class:"section-desc"},"设置您的用卡人信息",-1)),d("div",R,[e(V,{ref_key:"formRef",ref:b,model:l.value,rules:P,"label-width":"0",class:"user-form"},{default:a(()=>[e(y,{gutter:16},{default:a(()=>[e(s,{span:24},{default:a(()=>[e(u,{prop:"country"},{default:a(()=>[e(m,{modelValue:l.value.country,"onUpdate:modelValue":t[1]||(t[1]=o=>l.value.country=o),placeholder:"国家",style:{width:"100%"}},{default:a(()=>[e(r,{label:"中国",value:"CN"}),e(r,{label:"香港",value:"HK"}),e(r,{label:"美国",value:"US"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:a(()=>[e(u,{prop:"firstName"},{default:a(()=>[e(p,{modelValue:l.value.firstName,"onUpdate:modelValue":t[2]||(t[2]=o=>l.value.firstName=o),placeholder:"名"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:a(()=>[e(u,{prop:"lastName"},{default:a(()=>[e(p,{modelValue:l.value.lastName,"onUpdate:modelValue":t[3]||(t[3]=o=>l.value.lastName=o),placeholder:"姓"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:a(()=>[e(u,{prop:"birthday"},{default:a(()=>[e(k,{modelValue:l.value.birthday,"onUpdate:modelValue":t[4]||(t[4]=o=>l.value.birthday=o),type:"date",placeholder:"生日",style:{width:"100%"},"value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:a(()=>[e(u,{prop:"email"},{default:a(()=>[e(p,{modelValue:l.value.email,"onUpdate:modelValue":t[5]||(t[5]=o=>l.value.email=o),placeholder:"电子邮箱"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:a(()=>[e(u,{prop:"phone",class:"phone-item"},{default:a(()=>[e(p,{modelValue:l.value.phone,"onUpdate:modelValue":t[7]||(t[7]=o=>l.value.phone=o),placeholder:"手机号"},{prepend:a(()=>[e(m,{modelValue:l.value.phonePrefix,"onUpdate:modelValue":t[6]||(t[6]=o=>l.value.phonePrefix=o),style:{width:"70px"}},{default:a(()=>[e(r,{label:"+86",value:"86"}),e(r,{label:"+1",value:"1"})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])]),d("div",S,[t[17]||(t[17]=d("div",{class:"section-title"},"账单地址",-1)),t[18]||(t[18]=d("div",{class:"section-desc"},[_("为不影响下订单和正常使用，用卡人的账单地址建议填写成实际收货或为中国地址。"),d("br"),d("span",{class:"tip"},"Discover Card：所有卡均限")],-1)),d("div",E,[e(V,{ref_key:"addressFormRef",ref:N,model:l.value,"label-width":"0",class:"address-form"},{default:a(()=>[e(y,{gutter:16},{default:a(()=>[e(s,{span:24},{default:a(()=>[e(u,{prop:"billCountry"},{default:a(()=>[e(m,{modelValue:l.value.billCountry,"onUpdate:modelValue":t[8]||(t[8]=o=>l.value.billCountry=o),placeholder:"国家",style:{width:"100%"}},{default:a(()=>[e(r,{label:"中国",value:"CN"}),e(r,{label:"香港",value:"HK"}),e(r,{label:"美国",value:"US"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:a(()=>[e(u,{prop:"billProvince"},{default:a(()=>[e(p,{modelValue:l.value.billProvince,"onUpdate:modelValue":t[9]||(t[9]=o=>l.value.billProvince=o),placeholder:"省份/州"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:12},{default:a(()=>[e(u,{prop:"billCity"},{default:a(()=>[e(p,{modelValue:l.value.billCity,"onUpdate:modelValue":t[10]||(t[10]=o=>l.value.billCity=o),placeholder:"城市"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:a(()=>[e(u,{prop:"billAddress"},{default:a(()=>[e(p,{modelValue:l.value.billAddress,"onUpdate:modelValue":t[11]||(t[11]=o=>l.value.billAddress=o),placeholder:"详细地址"},null,8,["modelValue"])]),_:1})]),_:1}),e(s,{span:24},{default:a(()=>[e(u,{prop:"billPostcode"},{default:a(()=>[e(p,{modelValue:l.value.billPostcode,"onUpdate:modelValue":t[12]||(t[12]=o=>l.value.billPostcode=o),placeholder:"邮编"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])]),d("div",j,[e(C,{class:"back-btn",onClick:t[13]||(t[13]=o=>n.$emit("close"))},{default:a(()=>t[19]||(t[19]=[_("返回")])),_:1}),e(C,{type:"primary",class:"submit-btn",onClick:U},{default:a(()=>t[20]||(t[20]=[_("提交")])),_:1})])])}}},T=x(H,[["__scopeId","data-v-e218f128"]]);export{T as default};
